/*
 * API_delay.c
 *
 *  Created on: Sep 7, 2022
 *      Author: diego
 */


#include "SensorTemp.h"
#include <stdlib.h>
#include "API_uart.h"

static void MX_ADC1_Init(void);

uint8_t msg[2] = {'a','b'};
ADC_HandleTypeDef hadc1;

void SensorTemp_Init(){
	uartInit();
	MX_ADC1_Init();
}


int8_t SensorTemp_Read(void){
	uint16_t AD_RES = 0;
	HAL_ADC_Start(&hadc1);
	// Poll ADC1 Perihperal & TimeOut = 1mSec
	HAL_ADC_PollForConversion(&hadc1, 1);
	// Read The ADC Conversion Result & Map It To PWM DutyCycle
	AD_RES = HAL_ADC_GetValue(&hadc1);
	uartSendString((uint8_t *) &AD_RES);
	return AD_RES;
}



int str_to_decimal(const char *s)
{
    const char *digits = "0123456789";
    int result = 0;
    bool flagNegativo = false;
    if (*s == '-') {
    	flagNegativo = true;
	}

    for (; *s; ++s) {
        int digit_val;

        /* Find the index of the digit (equivalent to its numeric value) */
        for (digit_val = 0; digits[digit_val]; ++digit_val) {
            if (digits[digit_val] == *s)
                break;
        }

        /* Only process recognized digits */
        if (digits[digit_val])
            result = 10 * result + digit_val;
    }

    if (flagNegativo) {
		result = -result;
	}

    return result;
}

